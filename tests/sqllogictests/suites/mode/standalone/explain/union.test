statement ok
drop view if exists v

statement ok
drop table if exists t1

statement ok
drop table if exists t2

statement ok
create table t1 (a int, b int)

statement ok
insert into t1 values (1, 2), (2, 3)

statement ok
create table t2 (a int, b int)

statement ok
insert into t2 values (1, 2), (2, 3)

statement ok
create view v as select * from t1 union all select * from t2

query T
explain select * from v where a > b
----
UnionAll
├── Filter
│   ├── filters: [gt(v.a (#0), v.b (#1))]
│   └── TableScan
│       ├── table: default.default.t1
│       ├── read rows: 0
│       ├── read bytes: 0
│       ├── partitions total: 1
│       ├── partitions scanned: 0
│       └── push downs: [filters: [gt(a, b)], limit: NONE]
└── Filter
    ├── filters: [gt(a (#2), b (#3))]
    └── TableScan
        ├── table: default.default.t2
        ├── read rows: 0
        ├── read bytes: 0
        ├── partitions total: 1
        ├── partitions scanned: 0
        └── push downs: [filters: [gt(a, b)], limit: NONE]

query T
explain select * from v where a > 1
----
UnionAll
├── Filter
│   ├── filters: [gt(v.a (#0), 1_u8)]
│   └── TableScan
│       ├── table: default.default.t1
│       ├── read rows: 2
│       ├── read bytes: 62
│       ├── partitions total: 1
│       ├── partitions scanned: 1
│       └── push downs: [filters: [gt(a, 1_i32)], limit: NONE]
└── Filter
    ├── filters: [gt(a (#2), 1_u8)]
    └── TableScan
        ├── table: default.default.t2
        ├── read rows: 2
        ├── read bytes: 62
        ├── partitions total: 1
        ├── partitions scanned: 1
        └── push downs: [filters: [gt(a, 1_i32)], limit: NONE]

query T
explain select * from v limit 3
----
Limit
├── limit: 3
├── offset: 0
└── UnionAll
    ├── Limit
    │   ├── limit: 3
    │   ├── offset: 0
    │   └── TableScan
    │       ├── table: default.default.t1
    │       ├── read rows: 2
    │       ├── read bytes: 62
    │       ├── partitions total: 1
    │       ├── partitions scanned: 1
    │       └── push downs: [filters: [], limit: 3]
    └── Limit
        ├── limit: 3
        ├── offset: 0
        └── TableScan
            ├── table: default.default.t2
            ├── read rows: 2
            ├── read bytes: 62
            ├── partitions total: 1
            ├── partitions scanned: 1
            └── push downs: [filters: [], limit: 3]

query T
explain select * from v limit 3 offset 1
----
Limit
├── limit: 3
├── offset: 1
└── UnionAll
    ├── Limit
    │   ├── limit: 4
    │   ├── offset: 0
    │   └── TableScan
    │       ├── table: default.default.t1
    │       ├── read rows: 2
    │       ├── read bytes: 62
    │       ├── partitions total: 1
    │       ├── partitions scanned: 1
    │       └── push downs: [filters: [], limit: 4]
    └── Limit
        ├── limit: 4
        ├── offset: 0
        └── TableScan
            ├── table: default.default.t2
            ├── read rows: 2
            ├── read bytes: 62
            ├── partitions total: 1
            ├── partitions scanned: 1
            └── push downs: [filters: [], limit: 4]

query T
explain select * from t1 union all select * from t2 limit 1
----
Limit
├── limit: 1
├── offset: 0
└── UnionAll
    ├── Limit
    │   ├── limit: 1
    │   ├── offset: 0
    │   └── TableScan
    │       ├── table: default.default.t1
    │       ├── read rows: 2
    │       ├── read bytes: 62
    │       ├── partitions total: 1
    │       ├── partitions scanned: 1
    │       └── push downs: [filters: [], limit: 1]
    └── Limit
        ├── limit: 1
        ├── offset: 0
        └── TableScan
            ├── table: default.default.t2
            ├── read rows: 2
            ├── read bytes: 62
            ├── partitions total: 1
            ├── partitions scanned: 1
            └── push downs: [filters: [], limit: 1]

statement ok
drop table t1

statement ok
drop table t2

statement ok
drop view v
